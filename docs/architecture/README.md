# Architecture Documentation

–°–∏—Å—Ç–µ–º–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã, –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è EatFit24.

---

## üìã –î–æ–∫—É–º–µ–Ω—Ç—ã

### [Time & Timezone Policy](time.md)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –î–µ–π—Å—Ç–≤—É–µ—Ç

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–∏—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –∏ —Ç–∞–π–º–∑–æ–Ω–∞–º–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ

**–ö–ª—é—á–µ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ:** "If it runs on the server ‚Äî it's UTC"

**–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫:**
- Backend services (Django, Celery, PostgreSQL, Redis)
- Celery Beat schedules
- Logs & monitoring
- Database timestamps

**–ù–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫:**
- Frontend (user local time)
- Telegram Bot (Moscow time for users)
- Django Admin UI (Moscow time)

---

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. Single Source of Truth (SSOT)

**–ö–æ–¥ ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã.**

- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (–Ω–µ –≤ –ë–î, –Ω–µ –≤ runtime-—Ñ–∞–π–ª–∞—Ö)
- Runtime-–∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `celerybeat-schedule`) –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∏–∑ –∫–æ–¥–∞
- –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç —è–≤–Ω–æ–≥–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è/–¥–µ–ø–ª–æ—è

**–ü—Ä–∏–º–µ—Ä—ã:**
- Celery Beat schedule ‚Üí –≤ `config/celery.py`, –Ω–µ –≤ –ë–î
- Environment variables ‚Üí –≤ `.env.example` + production secrets

---

### 2. UTC Everywhere

**Backend –≤—Å–µ–≥–¥–∞ –≤ UTC, –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω–æ–º —Å–ª–æ–µ.**

- –£–ø—Ä–æ—â–∞–µ—Ç –æ—Ç–ª–∞–¥–∫—É
- –ò–∑–±–µ–≥–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å –ø–µ—Ä–µ—Ö–æ–¥–æ–º –Ω–∞ –ª–µ—Ç–Ω–µ–µ/–∑–∏–º–Ω–µ–µ –≤—Ä–µ–º—è
- –°—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è distributed systems

**–î–æ–∫—É–º–µ–Ω—Ç:** [time.md](time.md)

---

### 3. Fail-Fast

**–û—à–∏–±–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –∫–∞–∫ –º–æ–∂–Ω–æ —Ä–∞–Ω—å—à–µ.**

- Type checking (mypy –¥–ª—è Python, TypeScript –¥–ª—è frontend)
- Validation –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö —Å–∏—Å—Ç–µ–º—ã (API input, user input)
- Health checks –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤
- Automated tests –≤ CI/CD

---

### 4. Idempotency

**–û–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.**

**–ü—Ä–∏–º–µ—Ä—ã:**
- Celery tasks –ø—Ä–æ–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è idempotent
- Database migrations –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
- Deployment scripts –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

```
docs/
‚îú‚îÄ‚îÄ architecture/        # –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª - —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ README.md       # –ò–Ω–¥–µ–∫—Å (–≤—ã –∑–¥–µ—Å—å)
‚îÇ   ‚îî‚îÄ‚îÄ time.md         # –ü–æ–ª–∏—Ç–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
‚îÇ
‚îú‚îÄ‚îÄ operations/         # –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ celery-beat.md  # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Celery Beat
‚îÇ
‚îú‚îÄ‚îÄ infra/              # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îî‚îÄ‚îÄ API_DOCS.md         # API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π

1. **–û–±—Å—É–∂–¥–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å issue/discussion —Å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º
2. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π `.md` —Ñ–∞–π–ª
3. **–ö–æ–¥:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ
4. **Review:** Code review + architecture review
5. **Migration:** –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è, —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏
6. **Announce:** –£–≤–µ–¥–æ–º–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –æ –Ω–æ–≤–æ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ

---

## –ò—Å—Ç–æ—Ä–∏—è

| –î–∞—Ç–∞       | –î–æ–∫—É–º–µ–Ω—Ç | –î–µ–π—Å—Ç–≤–∏–µ |
|------------|----------|----------|
| 2025-12-24 | time.md  | –°–æ–∑–¥–∞–Ω   |
