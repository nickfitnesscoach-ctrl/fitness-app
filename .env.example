# =============================================================================
# EatFit24 Environment Variables
# Copy this file to .env and fill in real values
# =============================================================================

# =============================================================================
# ENVIRONMENT CONFIGURATION
# =============================================================================
# APP_ENV: dev | prod | test
# CRITICAL: This variable controls environment-specific guards and behavior
APP_ENV=prod

# Docker Compose project name (for DEV/PROD isolation)
# IMPORTANT: Use different names for dev and prod to avoid volume/network conflicts
COMPOSE_PROJECT_NAME=eatfit24_prod

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# CRITICAL: Do NOT use _dev, _test, or "test" in production database names
POSTGRES_DB=eatfit24_prod
POSTGRES_USER=eatfit24_prod
POSTGRES_PASSWORD=CHANGE_ME_GENERATE_WITH_openssl_rand_-hex_16
POSTGRES_HOST=db
POSTGRES_PORT=5432

# =============================================================================
# DJANGO BACKEND CONFIGURATION
# =============================================================================
DJANGO_SETTINGS_MODULE=config.settings.production
SECRET_KEY=CHANGE_ME_GENERATE_WITH_openssl_rand_-hex_32
DEBUG=False
ALLOWED_HOSTS=eatfit24.ru,www.eatfit24.ru
CORS_ALLOWED_ORIGINS=https://eatfit24.ru,https://www.eatfit24.ru

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
# CRITICAL: REDIS_URL is REQUIRED in production
# Include password if Redis is password-protected
REDIS_URL=redis://:YOUR_REDIS_PASSWORD@redis:6379/1

# =============================================================================
# CELERY CONFIGURATION
# =============================================================================
# CRITICAL: CELERY_BROKER_URL and CELERY_RESULT_BACKEND are REQUIRED
CELERY_BROKER_URL=redis://:YOUR_REDIS_PASSWORD@redis:6379/1
CELERY_RESULT_BACKEND=redis://:YOUR_REDIS_PASSWORD@redis:6379/2

# Django Runtime Flags (for entrypoint.sh)
# IMPORTANT: Use 1/0 (not true/false) - entrypoint.sh checks numeric values
RUN_MIGRATIONS=1
RUN_COLLECTSTATIC=1
MIGRATIONS_STRICT=1

# =============================================================================
# TELEGRAM BOT CONFIGURATION
# =============================================================================
TELEGRAM_BOT_TOKEN=CHANGE_ME_GET_FROM_BOTFATHER
TELEGRAM_BOT_API_SECRET=CHANGE_ME_GENERATE_WITH_openssl_rand_-hex_32
BOT_ADMIN_ID=310151740
ADMIN_IDS=310151740
TELEGRAM_ADMINS=310151740

# =============================================================================
# TELEGRAM MINI APP (Frontend URLs for bot)
# =============================================================================
# Development: https://your-ngrok-url.ngrok-free.app
# Production: https://eatfit24.ru/app (React app is served at /app path)
WEB_APP_URL=https://eatfit24.ru/app
TRAINER_PANEL_BASE_URL=https://eatfit24.ru/app

# =============================================================================
# DJANGO API URL (for bot to communicate with backend)
# =============================================================================
# Development (Docker): http://backend:8000/api/v1
# Production (Docker): http://backend:8000/api/v1
DJANGO_API_URL=http://backend:8000/api/v1

# =============================================================================
# AI API CONFIGURATION
# =============================================================================
OPENROUTER_API_KEY=CHANGE_ME_GET_FROM_OPENROUTER

# =============================================================================
# OPTIONAL: SWAGGER AUTH (Backend)
# =============================================================================
SWAGGER_AUTH_USERNAME=admin
SWAGGER_AUTH_PASSWORD=CHANGE_ME_GENERATE_WITH_openssl_rand_-base64_16

# =============================================================================
# BILLING CONFIGURATION
# =============================================================================
# YooKassa Shop ID and Secret Key
YOOKASSA_SHOP_ID=your_shop_id
YOOKASSA_SECRET_KEY=live_your_secret_key

# YooKassa mode: test or prod
# CRITICAL: Must be "prod" in production environment
YOOKASSA_MODE=prod

# Return URL after payment (where user is redirected after paying)
YOOKASSA_RETURN_URL=https://eatfit24.ru/payment-success

# Allowed domains for return_url validation (security: prevent open redirect)
ALLOWED_RETURN_URL_DOMAINS=eatfit24.ru,localhost

# Recurring payments toggle
# Set to false if YooKassa recurring is disabled/forbidden
# Set to true when YooKassa enables recurring payments
BILLING_RECURRING_ENABLED=false

# Webhook Security: Trust X-Forwarded-For from reverse proxy
# ВАЖНО: Включать только если webhook находится за nginx/reverse proxy
# В production за docker+nginx ОБЯЗАТЕЛЬНО должно быть true
WEBHOOK_TRUST_XFF=true

# Webhook Security: Trusted proxy IPs (nginx, docker gateway)
# Формат: comma-separated list of IPs or CIDR ranges
# 127.0.0.1 - localhost (nginx на том же хосте)
# 172.23.0.0/16 - docker network subnet
WEBHOOK_TRUSTED_PROXIES=127.0.0.1,172.23.0.0/16
